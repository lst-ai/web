<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSTéŠæˆ²å®¤-ğŸ”­ã€Šæ­·å²æœ›é é¡ã€‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Noto Sans TC', sans-serif;
        }
        
        .telescope-animation {
            animation: telescope-glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes telescope-glow {
            0% { transform: scale(1) rotate(0deg); filter: brightness(1); }
            100% { transform: scale(1.05) rotate(2deg); filter: brightness(1.2); }
        }
        
        .drag-item {
            transition: all 0.3s ease;
            cursor: grab;
        }
        
        .drag-item:active {
            cursor: grabbing;
            transform: scale(1.1);
            z-index: 1000;
        }
        
        .drop-zone {
            transition: all 0.3s ease;
            border: 2px dashed transparent;
        }
        
        .drop-zone.drag-over {
            border-color: #3b82f6;
            background-color: rgba(59, 130, 246, 0.1);
            transform: scale(1.02);
        }
        
        .success-animation {
            animation: success-bounce 0.6s ease-out;
        }
        
        @keyframes success-bounce {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .category-card {
            transition: all 0.3s ease;
        }
        
        .category-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .celebration {
            animation: celebration 1s ease-out;
        }
        
        @keyframes celebration {
            0% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.2) rotate(5deg); }
            50% { transform: scale(1.1) rotate(-5deg); }
            75% { transform: scale(1.15) rotate(3deg); }
            100% { transform: scale(1) rotate(0deg); }
        }
        
        .sparkle {
            animation: sparkle 0.8s ease-out;
        }
        
        @keyframes sparkle {
            0% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1.2); }
            100% { opacity: 0; transform: scale(1); }
        }
        
        .completed-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .item-image {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 12px;
            background: white;
            padding: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-400 via-pink-400 to-blue-500 min-h-screen">
    <!-- éŠæˆ²å®¹å™¨ -->
    <div id="gameContainer" class="container mx-auto px-4 py-8 max-w-6xl">
        
        <!-- ç¬¬ä¸€é ï¼šéŠæˆ²ç°¡ä»‹ -->
        <div id="introPage" class="text-center fade-in">
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-8 shadow-2xl">
                <div class="telescope-animation text-8xl mb-6">ğŸ”­</div>
                <h1 class="text-4xl font-bold text-gray-800 mb-2">LSTéŠæˆ²å®¤-ã€Šæ­·å²æœ›é é¡ã€‹</h1>
                <h2 class="text-2xl font-medium text-purple-600 mb-6">æ™‚ä»£è¿½è¿½è¿½ï¼šç”Ÿæ´»æ¼”åŒ–ç¯‡</h2>
                <p class="text-lg text-gray-700 mb-8 leading-relaxed max-w-2xl mx-auto">
                    æ­¡è¿ä¾†åˆ°ã€Šæ™‚ä»£è¿½è¿½è¿½ã€‹ï¼é€™æ˜¯ä¸€å ´ç‰©å“æ¼”åŒ–å¤§æŒ‘æˆ°ï¼Œ<br>
                    è«‹ä½¿ç”¨æ­·å²æœ›é é¡ï¼Œç…§å‡ºæ­£ç¢ºçš„æ™‚é–“é †åºï¼Œå®Œæˆä»»å‹™å§ï¼
                </p>
                <button onclick="showCategoryPage()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-4 rounded-full text-xl font-semibold hover:from-purple-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300 shadow-lg">
                    ğŸ® é–‹å§‹éŠæˆ²
                </button>
                
                <div class="mt-8 pt-6 border-t border-gray-200 text-center">
                    <p class="text-sm text-gray-600">
                        éŠæˆ²è¨­è¨ˆèˆ‡è£½ä½œï¼šå‘‚èˆ’å©·ï½œ<a href="#" class="text-purple-600 hover:text-purple-800 transition-colors">äº†è§£æ›´å¤šğŸ”</a>
                    </p>
                    <p class="text-sm text-gray-600 mt-1">
                        è‡‰æ›¸æœå°‹ï¼šå‘‚èˆ’å©·ï½œğŸ“§ <a href="mailto:luuyobi@gmail.com" class="text-purple-600 hover:text-purple-800 transition-colors">luuyobi@gmail.com</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- ç¬¬äºŒé ï¼šä¸»é¡Œé¸æ“‡ -->
        <div id="categoryPage" class="hidden fade-in">
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-8 shadow-2xl">
                <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">é¸æ“‡ä½ çš„æŒ‘æˆ°ä¸»é¡Œ</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="categoryGrid">
                    
                    <div class="category-card bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl p-6 text-white cursor-pointer relative" onclick="showLearningPage('transport')" data-category="transport">
                        <div class="text-5xl mb-4">ğŸš—</div>
                        <h3 class="text-xl font-semibold mb-2">äº¤é€šå·¥å…·æ¼”é€²</h3>
                        <p class="text-blue-100">é£›å¤©è·‘åœ°è®Šè®Šè®Š</p>
                    </div>
                    
                    <div class="category-card bg-gradient-to-br from-pink-400 to-pink-600 rounded-2xl p-6 text-white cursor-pointer relative" onclick="showLearningPage('clothing')" data-category="clothing">
                        <div class="text-5xl mb-4">ğŸ‘—</div>
                        <h3 class="text-xl font-semibold mb-2">è¡£è‘—æ¼”è®Š</h3>
                        <p class="text-pink-100">è¡£èµ·è®Šèº«ç§€</p>
                    </div>
                    
                    <div class="category-card bg-gradient-to-br from-green-400 to-green-600 rounded-2xl p-6 text-white cursor-pointer relative" onclick="showLearningPage('communication')" data-category="communication">
                        <div class="text-5xl mb-4">ğŸ“±</div>
                        <h3 class="text-xl font-semibold mb-2">é€šè¨Šå·¥å…·</h3>
                        <p class="text-green-100">è²è²ä¸æ¯å‚³å¿ƒæ„</p>
                    </div>
                    
                    <div class="category-card bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl p-6 text-white cursor-pointer relative" onclick="showLearningPage('writing')" data-category="writing">
                        <div class="text-5xl mb-4">âœï¸</div>
                        <h3 class="text-xl font-semibold mb-2">æ›¸å¯«å·¥å…·</h3>
                        <p class="text-yellow-100">ä¸€ç­†å¯«åƒå¹´</p>
                    </div>
                    
                    <div class="category-card bg-gradient-to-br from-purple-400 to-purple-600 rounded-2xl p-6 text-white cursor-pointer relative" onclick="showLearningPage('lighting')" data-category="lighting">
                        <div class="text-5xl mb-4">ğŸ’¡</div>
                        <h3 class="text-xl font-semibold mb-2">ç…§æ˜å·¥å…·</h3>
                        <p class="text-purple-100">é»‘å¤œè®Šå…‰æ˜</p>
                    </div>
                    
                    <div class="category-card bg-gradient-to-br from-red-400 to-red-600 rounded-2xl p-6 text-white cursor-pointer relative" onclick="showLearningPage('photography')" data-category="photography">
                        <div class="text-5xl mb-4">ğŸ“·</div>
                        <h3 class="text-xl font-semibold mb-2">ç…§ç›¸å·¥å…·</h3>
                        <p class="text-red-100">å’”åš“æ¼”åŒ–å²</p>
                    </div>
                </div>
                
                <div class="text-center mt-8">
                    <button onclick="showIntroPage()" class="bg-gray-500 text-white px-6 py-3 rounded-full hover:bg-gray-600 transition-colors">
                        â† è¿”å›é¦–é 
                    </button>
                </div>
            </div>
        </div>

        <!-- ç¬¬ä¸‰é ï¼šå­¸ç¿’é  -->
        <div id="learningPage" class="hidden fade-in">
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-8 shadow-2xl">
                <h2 id="learningTitle" class="text-3xl font-bold text-center text-gray-800 mb-8"></h2>
                <div id="learningContent" class="text-center mb-8">
                    <!-- å‹•æ…‹å…§å®¹å°‡åœ¨é€™è£¡é¡¯ç¤º -->
                </div>
                <div class="text-center">
                    <button id="startGameBtn" class="bg-gradient-to-r from-green-500 to-blue-500 text-white px-8 py-4 rounded-full text-xl font-semibold hover:from-green-600 hover:to-blue-600 transform hover:scale-105 transition-all duration-300 shadow-lg">
                        ğŸ¯ é–‹å§‹æŒ‘æˆ°
                    </button>
                    <button onclick="showCategoryPage()" class="ml-4 bg-gray-500 text-white px-6 py-3 rounded-full hover:bg-gray-600 transition-colors">
                        â† è¿”å›é¸æ“‡
                    </button>
                </div>
            </div>
        </div>

        <!-- ç¬¬å››é ï¼šä»»å‹™é  -->
        <div id="gamePage" class="hidden fade-in">
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-8 shadow-2xl">
                <div class="flex justify-between items-center mb-8">
                    <h2 id="gameTitle" class="text-3xl font-bold text-gray-800"></h2>
                    <div class="text-right">
                        <div id="questionCounter" class="text-lg font-semibold text-purple-600"></div>
                        <div id="score" class="text-sm text-gray-600">å¾—åˆ†: 0</div>
                    </div>
                </div>
                
                <div id="gameContent">
                    <div class="mb-8">
                        <h3 class="text-xl font-semibold text-gray-700 mb-4">è«‹å°‡ç‰©å“æŒ‰ç…§æ™‚ä»£é †åºæ’åˆ—ï¼ˆå¾å¤åˆ°ä»Šï¼‰ï¼š</h3>
                        
                        <!-- æ‹–æ›³ç‰©å“å€åŸŸ -->
                        <div id="dragItems" class="flex flex-wrap justify-center gap-4 mb-8 p-6 bg-gray-50 rounded-2xl">
                            <!-- å‹•æ…‹ç”Ÿæˆæ‹–æ›³ç‰©å“ -->
                        </div>
                        
                        <!-- æ”¾ç½®å€åŸŸ -->
                        <div id="dropZones" class="flex justify-center gap-4 mb-8">
                            <!-- å‹•æ…‹ç”Ÿæˆæ”¾ç½®å€åŸŸ -->
                        </div>
                        
                        <div class="text-center">
                            <button id="checkAnswer" class="bg-blue-500 text-white px-6 py-3 rounded-full hover:bg-blue-600 transition-colors mr-4" onclick="checkAnswer()">
                                âœ… æª¢æŸ¥ç­”æ¡ˆ
                            </button>
                            <button id="resetGame" class="bg-yellow-500 text-white px-6 py-3 rounded-full hover:bg-yellow-600 transition-colors mr-4" onclick="resetCurrentQuestion()">
                                ğŸ”„ é‡æ–°æ’åˆ—
                            </button>
                            <button onclick="showCategoryPage()" class="bg-gray-500 text-white px-6 py-3 rounded-full hover:bg-gray-600 transition-colors">
                                â† è¿”å›é¸æ“‡
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å®Œæˆé  -->
        <div id="completePage" class="hidden fade-in">
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-8 shadow-2xl text-center">
                <div class="text-8xl mb-6">ğŸ†</div>
                <h2 class="text-4xl font-bold text-gray-800 mb-4">æ­å–œå®Œæˆï¼</h2>
                <p id="completionMessage" class="text-xl text-gray-700 mb-6"></p>
                <div id="badge" class="text-6xl mb-6"></div>
                <div class="space-x-4">
                    <button onclick="showCategoryPage()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-4 rounded-full text-xl font-semibold hover:from-purple-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300 shadow-lg">
                        ğŸ® é¸æ“‡å…¶ä»–ä¸»é¡Œ
                    </button>
                    <button onclick="showIntroPage()" class="bg-gray-500 text-white px-6 py-3 rounded-full hover:bg-gray-600 transition-colors">
                        ğŸ  è¿”å›é¦–é 
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // éŠæˆ²æ•¸æ“š
        const gameData = {
            transport: {
                title: "äº¤é€šå·¥å…·æ¼”é€²",
                subtitle: "é£›å¤©è·‘åœ°è®Šè®Šè®Š",
                badge: "ğŸš—",
                questions: [
                    {
                        items: [
                            { name: "é¦¬è»Š", emoji: "ğŸ", order: 1 },
                            { name: "ç«è»Š", emoji: "ğŸš‚", order: 2 },
                            { name: "æ±½è»Š", emoji: "ğŸš—", order: 3 }
                        ]
                    },
                    {
                        items: [
                            { name: "ç†±æ°£çƒ", emoji: "ğŸˆ", order: 1 },
                            { name: "é£›æ©Ÿ", emoji: "âœˆï¸", order: 2 },
                            { name: "é«˜éµ", emoji: "ğŸš„", order: 3 }
                        ]
                    }
                ]
            },
            clothing: {
                title: "è¡£è‘—æ¼”è®Š",
                subtitle: "è¡£èµ·è®Šèº«ç§€",
                badge: "ğŸ‘—",
                questions: [
                    {
                        items: [
                            { name: "æ¸…æœé•·è¢", emoji: "ğŸ¥»", order: 1 },
                            { name: "æ°‘åˆæ´‹è£", emoji: "ğŸ‘—", order: 2 },
                            { name: "ç¾ä»£é€£å¸½å¤–å¥—", emoji: "ğŸ§¥", order: 3 }
                        ]
                    },
                    {
                        items: [
                            { name: "å¤ä»£è‰é‹", emoji: "ğŸ¥¿", order: 1 },
                            { name: "é»‘çš®é‹", emoji: "ğŸ‘", order: 2 },
                            { name: "é‹å‹•é‹", emoji: "ğŸ‘Ÿ", order: 3 }
                        ]
                    }
                ]
            },
            communication: {
                title: "é€šè¨Šå·¥å…·",
                subtitle: "è²è²ä¸æ¯å‚³å¿ƒæ„",
                badge: "ğŸ“±",
                questions: [
                    {
                        items: [
                            { name: "æ›¸ä¿¡", emoji: "âœ‰ï¸", order: 1 },
                            { name: "é›»è©±", emoji: "â˜ï¸", order: 2 },
                            { name: "æ‰‹æ©Ÿ", emoji: "ğŸ“±", order: 3 }
                        ]
                    },
                    {
                        items: [
                            { name: "å£ä¿¡", emoji: "ğŸ—£ï¸", order: 1 },
                            { name: "é›»å ±", emoji: "ğŸ“ ", order: 2 },
                            { name: "Line", emoji: "ğŸ’¬", order: 3 }
                        ]
                    }
                ]
            },
            writing: {
                title: "æ›¸å¯«å·¥å…·",
                subtitle: "ä¸€ç­†å¯«åƒå¹´",
                badge: "âœï¸",
                questions: [
                    {
                        items: [
                            { name: "ç«¹ç°¡", emoji: "ğŸ‹", order: 1 },
                            { name: "æ¯›ç­†", emoji: "ğŸ–Œï¸", order: 2 },
                            { name: "é‹¼ç­†", emoji: "ğŸ–‹ï¸", order: 3 }
                        ]
                    },
                    {
                        items: [
                            { name: "é‹¼ç­†", emoji: "ğŸ–‹ï¸", order: 1 },
                            { name: "åŸå­ç­†", emoji: "ğŸ–Šï¸", order: 2 },
                            { name: "ç­†é›»æ‰“å­—", emoji: "ğŸ’»", order: 3 }
                        ]
                    }
                ]
            },
            lighting: {
                title: "ç…§æ˜å·¥å…·",
                subtitle: "é»‘å¤œè®Šå…‰æ˜",
                badge: "ğŸ’¡",
                questions: [
                    {
                        items: [
                            { name: "ç«æŠŠ", emoji: "ğŸ”¥", order: 1 },
                            { name: "æ²¹ç‡ˆ", emoji: "ğŸª”", order: 2 },
                            { name: "LEDç‡ˆ", emoji: "ğŸ’¡", order: 3 }
                        ]
                    },
                    {
                        items: [
                            { name: "ç«å †", emoji: "ğŸ”¥", order: 1 },
                            { name: "è Ÿç‡­", emoji: "ğŸ•¯ï¸", order: 2 },
                            { name: "æ‰‹é›»ç­’", emoji: "ğŸ”¦", order: 3 }
                        ]
                    }
                ]
            },
            photography: {
                title: "ç…§ç›¸å·¥å…·",
                subtitle: "å’”åš“æ¼”åŒ–å²",
                badge: "ğŸ“·",
                questions: [
                    {
                        items: [
                            { name: "é»‘ç™½ç›¸æ©Ÿ", emoji: "ğŸ“·", order: 1 },
                            { name: "æ‹ç«‹å¾—", emoji: "ğŸ“¸", order: 2 },
                            { name: "æ‰‹æ©Ÿç›¸æ©Ÿ", emoji: "ğŸ“±", order: 3 }
                        ]
                    },
                    {
                        items: [
                            { name: "å¤§å‹ç›¸æ©Ÿ", emoji: "ğŸ“·", order: 1 },
                            { name: "æ•¸ä½ç›¸æ©Ÿ", emoji: "ğŸ“¸", order: 2 },
                            { name: "è‡ªæ‹æ£’", emoji: "ğŸ¤³", order: 3 }
                        ]
                    }
                ]
            }
        };

        let currentCategory = '';
        let currentQuestionIndex = 0;
        let score = 0;
        let draggedElement = null;
        let completedCategories = JSON.parse(localStorage.getItem('completedCategories') || '[]');

        // é é¢åˆ‡æ›å‡½æ•¸
        function showIntroPage() {
            hideAllPages();
            document.getElementById('introPage').classList.remove('hidden');
        }

        function showCategoryPage() {
            hideAllPages();
            document.getElementById('categoryPage').classList.remove('hidden');
            updateCompletionBadges();
        }
        
        function updateCompletionBadges() {
            const categoryCards = document.querySelectorAll('.category-card');
            categoryCards.forEach(card => {
                const category = card.dataset.category;
                const existingBadge = card.querySelector('.completed-badge');
                
                if (completedCategories.includes(category)) {
                    if (!existingBadge) {
                        const badge = document.createElement('div');
                        badge.className = 'completed-badge';
                        badge.innerHTML = 'âœ“';
                        card.appendChild(badge);
                    }
                } else if (existingBadge) {
                    existingBadge.remove();
                }
            });
        }

        function showLearningPage(category) {
            currentCategory = category;
            const data = gameData[category];
            
            hideAllPages();
            document.getElementById('learningPage').classList.remove('hidden');
            document.getElementById('learningTitle').textContent = data.title;
            
            // é¡¯ç¤ºå­¸ç¿’å…§å®¹
            const learningContent = document.getElementById('learningContent');
            learningContent.innerHTML = `
                <div class="text-6xl mb-6">${data.badge}</div>
                <h3 class="text-2xl font-semibold text-gray-700 mb-4">${data.subtitle}</h3>
                <p class="text-lg text-gray-600 mb-6">è§€å¯Ÿé€™äº›ç‰©å“çš„æ¼”é€²éç¨‹ï¼Œäº†è§£ç§‘æŠ€å¦‚ä½•æ”¹è®Šæˆ‘å€‘çš„ç”Ÿæ´»ï¼</p>
                <div class="flex justify-center items-center space-x-8 text-4xl">
                    ${data.questions[0].items.map(item => item.emoji).join(' â†’ ')}
                </div>
            `;
            
            document.getElementById('startGameBtn').onclick = () => startGame(category);
        }

        function startGame(category) {
            currentCategory = category;
            currentQuestionIndex = 0;
            score = 0;
            
            hideAllPages();
            document.getElementById('gamePage').classList.remove('hidden');
            document.getElementById('gameTitle').textContent = gameData[category].title;
            
            loadQuestion();
        }

        function loadQuestion() {
            const data = gameData[currentCategory];
            const question = data.questions[currentQuestionIndex];
            
            document.getElementById('questionCounter').textContent = 
                `ç¬¬ ${currentQuestionIndex + 1} é¡Œ / ${data.questions.length} é¡Œ`;
            document.getElementById('score').textContent = `å¾—åˆ†: ${score}`;
            
            // å‰µå»ºæ‹–æ›³ç‰©å“
            const dragItems = document.getElementById('dragItems');
            dragItems.innerHTML = '';
            
            // éš¨æ©Ÿæ‰“äº‚é †åº
            const shuffledItems = [...question.items].sort(() => Math.random() - 0.5);
            
            shuffledItems.forEach((item, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'drag-item bg-white rounded-2xl p-4 shadow-lg border-2 border-gray-200 text-center min-w-[120px]';
                itemDiv.draggable = true;
                itemDiv.dataset.order = item.order;
                itemDiv.innerHTML = `
                    <div class="text-4xl mb-2">${item.emoji}</div>
                    <div class="text-sm font-medium text-gray-700">${item.name}</div>
                `;
                
                itemDiv.addEventListener('dragstart', handleDragStart);
                itemDiv.addEventListener('dragend', handleDragEnd);
                
                dragItems.appendChild(itemDiv);
            });
            
            // å‰µå»ºæ”¾ç½®å€åŸŸ
            const dropZones = document.getElementById('dropZones');
            dropZones.innerHTML = '';
            
            for (let i = 1; i <= question.items.length; i++) {
                const dropZone = document.createElement('div');
                dropZone.className = 'drop-zone bg-gray-100 border-2 border-dashed border-gray-300 rounded-2xl p-6 min-w-[140px] min-h-[120px] flex flex-col items-center justify-center';
                dropZone.dataset.position = i;
                dropZone.innerHTML = `
                    <div class="text-2xl text-gray-400 mb-2">${i}</div>
                    <div class="text-sm text-gray-500">æ‹–æ›³åˆ°é€™è£¡</div>
                `;
                
                dropZone.addEventListener('dragover', handleDragOver);
                dropZone.addEventListener('drop', handleDrop);
                dropZone.addEventListener('dragenter', handleDragEnter);
                dropZone.addEventListener('dragleave', handleDragLeave);
                
                dropZones.appendChild(dropZone);
            }
        }

        function hideAllPages() {
            const pages = ['introPage', 'categoryPage', 'learningPage', 'gamePage', 'completePage'];
            pages.forEach(pageId => {
                document.getElementById(pageId).classList.add('hidden');
            });
        }

        // æ‹–æ‹½äº‹ä»¶è™•ç†
        function handleDragStart(e) {
            draggedElement = e.target;
            e.target.style.opacity = '0.5';
        }

        function handleDragEnd(e) {
            e.target.style.opacity = '1';
            draggedElement = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDragEnter(e) {
            e.preventDefault();
            if (e.target.classList.contains('drop-zone')) {
                e.target.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            if (e.target.classList.contains('drop-zone')) {
                e.target.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.target.closest('.drop-zone');
            if (dropZone && draggedElement) {
                dropZone.classList.remove('drag-over');
                
                // å¦‚æœæ”¾ç½®å€åŸŸå·²æœ‰ç‰©å“ï¼Œå°‡å…¶ç§»å›åŸè™•
                const existingItem = dropZone.querySelector('.drag-item');
                if (existingItem) {
                    document.getElementById('dragItems').appendChild(existingItem);
                }
                
                // å°‡æ‹–æ›³çš„ç‰©å“æ”¾å…¥æ”¾ç½®å€åŸŸ
                dropZone.innerHTML = '';
                dropZone.appendChild(draggedElement);
                draggedElement.classList.remove('drag-item');
                draggedElement.classList.add('dropped-item');
            }
        }

        function checkAnswer() {
            const dropZones = document.querySelectorAll('.drop-zone');
            let correct = true;
            let answers = [];
            
            dropZones.forEach((zone, index) => {
                const item = zone.querySelector('.dropped-item');
                if (item) {
                    const expectedOrder = index + 1;
                    const actualOrder = parseInt(item.dataset.order);
                    answers.push(actualOrder);
                    
                    if (actualOrder !== expectedOrder) {
                        correct = false;
                        zone.classList.add('bg-red-100', 'border-red-300');
                    } else {
                        zone.classList.add('bg-green-100', 'border-green-300');
                    }
                } else {
                    correct = false;
                    zone.classList.add('bg-red-100', 'border-red-300');
                }
            });
            
            setTimeout(() => {
                if (correct) {
                    score += 100;
                    showSuccessMessage();
                } else {
                    showErrorMessage();
                }
            }, 1000);
        }

        function showSuccessMessage() {
            // å‰µå»ºæ…¶ç¥æ•ˆæœ
            createCelebrationEffect();
            
            // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50';
            successDiv.innerHTML = `
                <div class="bg-white rounded-3xl p-8 text-center celebration shadow-2xl max-w-md mx-4">
                    <div class="text-6xl mb-4">ğŸ‰</div>
                    <h3 class="text-2xl font-bold text-green-600 mb-2">æœ›é é¡ä¿®å¾©æˆåŠŸï¼</h3>
                    <p class="text-lg text-gray-700 mb-4">æ™‚é–“é †åºå®Œå…¨æ­£ç¢ºï¼</p>
                    <div class="text-3xl text-yellow-500">â­ +100 åˆ† â­</div>
                </div>
            `;
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                document.body.removeChild(successDiv);
                
                currentQuestionIndex++;
                const data = gameData[currentCategory];
                
                if (currentQuestionIndex >= data.questions.length) {
                    // æ¨™è¨˜ç‚ºå·²å®Œæˆ
                    if (!completedCategories.includes(currentCategory)) {
                        completedCategories.push(currentCategory);
                        localStorage.setItem('completedCategories', JSON.stringify(completedCategories));
                    }
                    showCompletePage();
                } else {
                    loadQuestion();
                }
            }, 2500);
        }
        
        function createCelebrationEffect() {
            // å‰µå»ºé–ƒçˆæ˜Ÿæ˜Ÿæ•ˆæœ
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'fixed text-4xl sparkle pointer-events-none z-40';
                    sparkle.innerHTML = 'âœ¨';
                    sparkle.style.left = Math.random() * window.innerWidth + 'px';
                    sparkle.style.top = Math.random() * window.innerHeight + 'px';
                    document.body.appendChild(sparkle);
                    
                    setTimeout(() => {
                        if (document.body.contains(sparkle)) {
                            document.body.removeChild(sparkle);
                        }
                    }, 800);
                }, i * 100);
            }
        }

        function showErrorMessage() {
            alert('âŒ æ­·å²æ··äº‚å•¦ï¼å†ä¾†ä¸€æ¬¡ï¼');
            setTimeout(() => {
                resetCurrentQuestion();
            }, 1000);
        }

        function resetCurrentQuestion() {
            // æ¸…é™¤æ‰€æœ‰æ¨£å¼
            const dropZones = document.querySelectorAll('.drop-zone');
            dropZones.forEach(zone => {
                zone.classList.remove('bg-red-100', 'border-red-300', 'bg-green-100', 'border-green-300');
                const item = zone.querySelector('.dropped-item');
                if (item) {
                    item.classList.remove('dropped-item');
                    item.classList.add('drag-item');
                    document.getElementById('dragItems').appendChild(item);
                }
            });
            
            loadQuestion();
        }

        function showCompletePage() {
            const data = gameData[currentCategory];
            
            hideAllPages();
            document.getElementById('completePage').classList.remove('hidden');
            document.getElementById('completionMessage').textContent = 
                `ä½ å®Œæˆäº†ã€Œ${data.title}ã€çš„æ‰€æœ‰æŒ‘æˆ°ï¼ç¸½å¾—åˆ†ï¼š${score} åˆ†`;
            document.getElementById('badge').textContent = data.badge;
        }

        // åˆå§‹åŒ–éŠæˆ²
        showIntroPage();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96beb06975c9f209',t:'MTc1NDY1MjcwNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
