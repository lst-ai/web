<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🌏 地球手套：環遊世界拍拍手</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        @keyframes wave {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            75% { transform: rotate(-5deg); }
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }
        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(3deg); }
            75% { transform: rotate(-3deg); }
        }
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 255, 255, 0.3); }
            50% { box-shadow: 0 0 40px rgba(255, 255, 255, 0.6), 0 0 60px rgba(255, 255, 255, 0.4); }
        }
        .float { animation: float 3s ease-in-out infinite; }
        .wave { animation: wave 2s ease-in-out infinite; }
        .bounce { animation: bounce 2s ease-in-out infinite; }
        .pulse { animation: pulse 2s ease-in-out infinite; }
        .sparkle { animation: sparkle 1.5s ease-in-out infinite; }
        .rainbow { animation: rainbow 3s linear infinite; }
        .wiggle { animation: wiggle 1s ease-in-out infinite; }
        .glow { animation: glow 2s ease-in-out infinite; }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #ff9a9e 75%, #fecfef 100%);
        }
        .card-gradient {
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0.1) 100%);
        }
        .world-map {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 60'%3E%3Cpath d='M20,20 Q30,15 40,20 T60,25 L65,30 Q70,35 75,30 L80,35' stroke='%23ffffff' stroke-width='0.5' fill='none' opacity='0.3'/%3E%3Cpath d='M15,35 Q25,30 35,35 T55,40 L60,45 Q65,50 70,45 L75,50' stroke='%23ffffff' stroke-width='0.5' fill='none' opacity='0.3'/%3E%3C/svg%3E");
            background-size: cover;
        }
        .glow {
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
        }
        .text-glow {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-400 via-purple-500 to-pink-500">
    <!-- Cover Page -->
    <div id="coverPage" class="min-h-screen flex flex-col items-center justify-center p-6 world-map">
        <div class="text-center space-y-8">
            <h1 class="text-5xl md:text-7xl font-bold text-white mb-4 drop-shadow-2xl rainbow">
                LST遊戲室-地球手套
            </h1>
            <h2 class="text-3xl md:text-5xl font-semibold text-yellow-300 mb-8 drop-shadow-lg wiggle">
                環遊世界拍拍手
            </h2>
            
            <div class="float text-9xl mb-8">
                🧤
            </div>
            
            <div class="flex justify-center space-x-6 mb-8">
                <span class="wave text-6xl glow">🇯🇵</span>
                <span class="wave text-6xl glow" style="animation-delay: 0.2s">🇺🇸</span>
                <span class="wave text-6xl glow" style="animation-delay: 0.4s">🇨🇦</span>
                <span class="wave text-6xl glow" style="animation-delay: 0.6s">🇧🇷</span>
                <span class="wave text-6xl glow" style="animation-delay: 0.8s">🇫🇷</span>
            </div>
            
            <!-- Floating decorative elements -->
            <div class="absolute top-20 left-10 text-4xl sparkle opacity-70">⭐</div>
            <div class="absolute top-32 right-16 text-3xl bounce opacity-60" style="animation-delay: 0.5s">🌟</div>
            <div class="absolute bottom-40 left-20 text-5xl float opacity-50" style="animation-delay: 1s">✨</div>
            <div class="absolute bottom-60 right-10 text-4xl wiggle opacity-70" style="animation-delay: 1.5s">🎯</div>
            
            <p class="text-xl md:text-2xl text-white font-semibold mb-12 max-w-2xl mx-auto leading-relaxed">
                戴上地球手套，出發修復地球的知識裂縫！
            </p>
            
            <button onclick="showMissionPage()" class="pulse bg-yellow-400 hover:bg-yellow-500 text-purple-800 font-bold py-6 px-12 rounded-full text-2xl shadow-lg transform transition-all duration-300 hover:scale-105 mb-8">
                🚀 開始冒險
            </button>
        </div>
        
        <!-- Footer -->
        <div class="absolute bottom-0 left-0 right-0 p-8 bg-black/20 backdrop-blur-sm">
            <div class="text-center text-white/80 text-lg">
                <p>遊戲設計與製作：呂舒婷｜🔍 臉書搜尋：呂舒婷｜📧 <a href="mailto:luuyobi@gmail.com" class="text-yellow-300 hover:text-yellow-200 transition-colors">luuyobi@gmail.com</a></p>
            </div>
        </div>
    </div>

    <!-- Mission Description Page -->
    <div id="missionPage" class="hidden min-h-screen flex flex-col items-center justify-center p-6 gradient-bg">
        <div class="text-center space-y-8 max-w-4xl mx-auto">
            <div class="bounce text-9xl mb-8">
                🎒🔍
            </div>
            
            <h2 class="text-4xl md:text-6xl font-bold text-white mb-8">
                探險任務說明
            </h2>
            
            <div class="bg-white/20 backdrop-blur-sm rounded-3xl p-10 mb-8 shadow-2xl">
                <p class="text-2xl md:text-3xl text-white font-semibold leading-relaxed">
                    探險員，你要前往世界各地完成<br>
                    <span class="text-yellow-300 text-3xl md:text-4xl">國旗篇、文化篇、飲食篇</span><br>
                    挑戰，找回地球失落的寶石！
                </p>
            </div>
            
            <button onclick="showChapterPage()" class="pulse bg-green-400 hover:bg-green-500 text-green-800 font-bold py-6 px-12 rounded-full text-2xl shadow-lg transform transition-all duration-300 hover:scale-105">
                🗺️ 出發！
            </button>
        </div>
    </div>

    <!-- Chapter Selection Page -->
    <div id="chapterPage" class="hidden min-h-screen flex flex-col items-center justify-center p-6 gradient-bg">
        <h2 class="text-4xl md:text-6xl font-bold text-white mb-12 text-center drop-shadow-2xl">
            選擇你的冒險篇章
        </h2>
        
        <div class="grid md:grid-cols-3 gap-10 max-w-7xl mx-auto">
            <div onclick="showLearningPage('flags')" class="cursor-pointer transform hover:scale-110 transition-all duration-300">
                <div class="card-gradient backdrop-blur-sm rounded-3xl p-10 text-center hover:bg-white/30 shadow-2xl border-2 border-yellow-300/50 glow">
                    <div class="text-8xl mb-6 bounce">🏴‍☠️</div>
                    <h3 class="text-3xl font-bold text-white mb-6">旗海任務</h3>
                    <p class="text-white/80 text-xl">探索世界各國國旗的秘密</p>
                </div>
            </div>
            
            <div onclick="showLearningPage('culture')" class="cursor-pointer transform hover:scale-110 transition-all duration-300">
                <div class="card-gradient backdrop-blur-sm rounded-3xl p-10 text-center hover:bg-white/30 shadow-2xl border-2 border-pink-300/50 glow" style="animation-delay: 0.2s">
                    <div class="text-8xl mb-6 wiggle">🎭</div>
                    <h3 class="text-3xl font-bold text-white mb-6">世界習俗探險</h3>
                    <p class="text-white/80 text-xl">發現各國獨特的文化傳統</p>
                </div>
            </div>
            
            <div onclick="showLearningPage('food')" class="cursor-pointer transform hover:scale-110 transition-all duration-300">
                <div class="card-gradient backdrop-blur-sm rounded-3xl p-10 text-center hover:bg-white/30 shadow-2xl border-2 border-green-300/50 glow" style="animation-delay: 0.4s">
                    <div class="text-8xl mb-6 float">🍽️</div>
                    <h3 class="text-3xl font-bold text-white mb-6">美食集章之旅</h3>
                    <p class="text-white/80 text-xl">品嚐世界各地的美味料理</p>
                </div>
            </div>
        </div>
        
        <button onclick="showCoverPage()" class="mt-12 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-full">
            🏠 回首頁
        </button>
    </div>

    <!-- Learning Page -->
    <div id="learningPage" class="hidden min-h-screen p-6 gradient-bg">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-10">
                <h2 id="learningTitle" class="text-4xl md:text-6xl font-bold text-white mb-6 drop-shadow-2xl"></h2>
                <button onclick="showChapterPage()" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-full mb-8 text-lg">
                    ← 返回篇章選擇
                </button>
            </div>
            
            <div id="learningCards" class="grid md:grid-cols-2 lg:grid-cols-4 gap-8 mb-10">
                <!-- Learning cards will be populated by JavaScript -->
            </div>
            
            <div class="text-center">
                <button onclick="startQuiz()" class="pulse bg-red-500 hover:bg-red-600 text-white font-bold py-6 px-12 rounded-full text-2xl shadow-lg transform transition-all duration-300 hover:scale-105">
                    🎯 開始挑戰
                </button>
            </div>
        </div>
    </div>

    <!-- Quiz Page -->
    <div id="quizPage" class="hidden min-h-screen p-6 gradient-bg">
        <div class="max-w-4xl mx-auto">
            <div class="text-center mb-10">
                <h2 class="text-4xl md:text-5xl font-bold text-white mb-6 drop-shadow-2xl">挑戰時間！</h2>
                <div class="bg-white/20 backdrop-blur-sm rounded-2xl p-6 mb-8 shadow-2xl">
                    <div class="flex justify-between items-center">
                        <span class="text-white font-semibold text-xl">進度：<span id="questionProgress">1/5</span></span>
                        <div class="flex space-x-2">
                            <div id="gem1" class="w-12 h-12 bg-gray-400 rounded-full flex items-center justify-center text-2xl">💎</div>
                            <div id="gem2" class="w-12 h-12 bg-gray-400 rounded-full flex items-center justify-center text-2xl">💎</div>
                            <div id="gem3" class="w-12 h-12 bg-gray-400 rounded-full flex items-center justify-center text-2xl">💎</div>
                            <div id="gem4" class="w-12 h-12 bg-gray-400 rounded-full flex items-center justify-center text-2xl">💎</div>
                            <div id="gem5" class="w-12 h-12 bg-gray-400 rounded-full flex items-center justify-center text-2xl">💎</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="questionCard" class="bg-white/20 backdrop-blur-sm rounded-3xl p-10 mb-10 shadow-2xl border border-white/20">
                <h3 id="questionText" class="text-3xl md:text-4xl font-bold text-white mb-8 text-center leading-relaxed"></h3>
                <div id="answerOptions" class="space-y-6">
                    <!-- Answer options will be populated by JavaScript -->
                </div>
            </div>
            
            <div id="feedback" class="hidden bg-white/20 backdrop-blur-sm rounded-3xl p-8 mb-8 shadow-2xl border border-white/20">
                <p id="feedbackText" class="text-2xl md:text-3xl text-white text-center leading-relaxed"></p>
            </div>
            
            <div class="text-center">
                <button id="nextButton" onclick="nextQuestion()" class="hidden bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-8 rounded-full text-xl">
                    下一題 →
                </button>
            </div>
        </div>
    </div>

    <!-- Completion Page -->
    <div id="completionPage" class="hidden min-h-screen flex flex-col items-center justify-center p-6 gradient-bg">
        <div class="text-center space-y-8">
            <div class="text-9xl mb-10 sparkle">
                🌍✨
            </div>
            
            <h2 class="text-5xl md:text-7xl font-bold text-white mb-10 drop-shadow-2xl">
                地球知識修復完成！
            </h2>
            
            <div class="bg-white/20 backdrop-blur-sm rounded-3xl p-10 mb-10 shadow-2xl border border-white/20">
                <p id="completionMessage" class="text-2xl md:text-3xl text-white font-semibold leading-relaxed">
                    恭喜你完成了挑戰！
                </p>
                <div class="flex justify-center space-x-3 mt-6">
                    <span class="sparkle text-4xl">💎</span>
                    <span class="sparkle text-4xl" style="animation-delay: 0.2s">💎</span>
                    <span class="sparkle text-4xl" style="animation-delay: 0.4s">💎</span>
                    <span class="sparkle text-4xl" style="animation-delay: 0.6s">💎</span>
                    <span class="sparkle text-4xl" style="animation-delay: 0.8s">💎</span>
                </div>
            </div>
            
            <div class="space-x-6">
                <button onclick="showChapterPage()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-6 px-12 rounded-full text-2xl shadow-lg transform transition-all duration-300 hover:scale-105">
                    🔄 再挑戰
                </button>
                <button onclick="showCoverPage()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-6 px-12 rounded-full text-2xl shadow-lg transform transition-all duration-300 hover:scale-105">
                    🏠 回首頁
                </button>
            </div>
        </div>
    </div>

    <script>
        // Game data
        const gameData = {
            flags: {
                title: "🏴‍☠️ 國旗篇",
                cards: [
                    { flag: "🇯🇵", country: "日本", info: "白底紅圓象徵太陽" },
                    { flag: "🇺🇸", country: "美國", info: "50 顆星代表州" },
                    { flag: "🇨🇦", country: "加拿大", info: "紅楓葉象徵自然" },
                    { flag: "🇧🇷", country: "巴西", info: "綠底黃菱形，象徵熱帶森林與黃金" },
                    { flag: "🇫🇷", country: "法國", info: "藍白紅代表自由平等博愛" },
                    { flag: "🇮🇳", country: "印度", info: "中央藍輪代表法輪" },
                    { flag: "🇬🇧", country: "英國", info: "聯合旗，融合英格蘭、蘇格蘭、愛爾蘭圖案" },
                    { flag: "🇰🇷", country: "韓國", info: "太極旗象徵陰陽平衡" }
                ],
                questions: [
                    { q: "哪國國旗有楓葉？", a: "加拿大", options: ["日本", "加拿大", "美國", "法國"], hint: "楓葉是加拿大的國樹" },
                    { q: "哪國國旗中間是紅太陽？", a: "日本", options: ["韓國", "日本", "印度", "中國"], hint: "日出之國" },
                    { q: "美國國旗有幾顆星？", a: "50", options: ["48", "50", "52", "49"], hint: "代表 50 州" },
                    { q: "哪國國旗有綠底黃菱形？", a: "巴西", options: ["巴西", "墨西哥", "阿根廷", "智利"], hint: "代表熱帶森林與黃金" },
                    { q: "法國國旗顏色順序是？", a: "藍白紅", options: ["紅白藍", "藍白紅", "白藍紅", "紅藍白"], hint: "從左到右" },
                    { q: "哪國國旗中央是藍色輪？", a: "印度", options: ["印度", "泰國", "日本", "韓國"], hint: "法輪象徵正義" },
                    { q: "哪國國旗是三種旗融合？", a: "英國", options: ["英國", "澳洲", "紐西蘭", "加拿大"], hint: "聯合旗" },
                    { q: "太極旗的圓形顏色是？", a: "紅藍", options: ["紅藍", "黑白", "藍白", "紅白"], hint: "陰陽平衡" },
                    { q: "哪國國旗綠色部分象徵森林？", a: "巴西", options: ["巴西", "墨西哥", "印度", "巴基斯坦"], hint: "熱帶雨林" },
                    { q: "法國國旗藍色象徵什麼？", a: "自由", options: ["自由", "平等", "博愛", "正義"], hint: "三色旗的第一個意義" }
                ]
            },
            culture: {
                title: "🎭 文化篇",
                cards: [
                    { flag: "🇯🇵", country: "日本", info: "新年吃年糕" },
                    { flag: "🇺🇸", country: "美國", info: "感恩節吃火雞" },
                    { flag: "🇮🇹", country: "義大利", info: "傳統披薩發源地" },
                    { flag: "🇨🇳", country: "中國", info: "春節貼春聯" },
                    { flag: "🇪🇬", country: "埃及", info: "金字塔與木乃伊" },
                    { flag: "🇲🇽", country: "墨西哥", info: "亡靈節彩繪頭骨" },
                    { flag: "🇰🇷", country: "韓國", info: "中秋吃松餅" },
                    { flag: "🇪🇸", country: "西班牙", info: "番茄節" }
                ],
                questions: [
                    { q: "哪國在感恩節吃火雞？", a: "美國", options: ["美國", "加拿大", "英國", "澳洲"], hint: "感恩節的傳統" },
                    { q: "哪國中秋節吃松餅？", a: "韓國", options: ["韓國", "日本", "中國", "越南"], hint: "韓式中秋傳統" },
                    { q: "義大利的代表美食是？", a: "披薩", options: ["披薩", "壽司", "漢堡", "捲餅"], hint: "義式經典" },
                    { q: "哪國會在春節貼春聯？", a: "中國", options: ["中國", "日本", "韓國", "越南"], hint: "農曆新年傳統" },
                    { q: "金字塔在哪個國家？", a: "埃及", options: ["埃及", "墨西哥", "印度", "希臘"], hint: "古文明遺跡" },
                    { q: "亡靈節是哪國節日？", a: "墨西哥", options: ["墨西哥", "西班牙", "阿根廷", "巴西"], hint: "彩繪頭骨慶典" },
                    { q: "番茄節在哪個國家舉行？", a: "西班牙", options: ["西班牙", "義大利", "法國", "葡萄牙"], hint: "番茄大戰" },
                    { q: "日本新年吃什麼？", a: "年糕", options: ["年糕", "壽司", "拉麵", "天婦羅"], hint: "新年傳統食物" },
                    { q: "埃及金字塔的用途之一是？", a: "法老陵墓", options: ["法老陵墓", "神廟", "倉庫", "天文台"], hint: "古代帝王長眠之地" },
                    { q: "春聯通常用什麼顏色？", a: "紅色", options: ["紅色", "金色", "黑色", "藍色"], hint: "吉祥的顏色" }
                ]
            },
            food: {
                title: "🍽️ 飲食篇",
                cards: [
                    { flag: "🇯🇵", country: "日本", info: "壽司" },
                    { flag: "🇺🇸", country: "美國", info: "漢堡" },
                    { flag: "🇮🇹", country: "義大利", info: "義大利麵" },
                    { flag: "🇲🇽", country: "墨西哥", info: "墨西哥捲餅" },
                    { flag: "🇫🇷", country: "法國", info: "牛角麵包" },
                    { flag: "🇹🇭", country: "泰國", info: "冬蔭功湯" },
                    { flag: "🇨🇳", country: "中國", info: "北京烤鴨" },
                    { flag: "🇰🇷", country: "韓國", info: "泡菜" }
                ],
                questions: [
                    { q: "哪國的代表食物是壽司？", a: "日本", options: ["日本", "韓國", "中國", "泰國"], hint: "生魚片料理" },
                    { q: "漢堡源自哪國？", a: "美國", options: ["美國", "德國", "英國", "加拿大"], hint: "速食文化代表" },
                    { q: "義大利麵是哪國料理？", a: "義大利", options: ["義大利", "法國", "西班牙", "希臘"], hint: "麵條料理發源地" },
                    { q: "墨西哥捲餅屬於哪國？", a: "墨西哥", options: ["墨西哥", "西班牙", "阿根廷", "智利"], hint: "玉米餅包裹料理" },
                    { q: "牛角麵包來自哪國？", a: "法國", options: ["法國", "義大利", "德國", "奧地利"], hint: "法式早餐經典" },
                    { q: "冬蔭功湯是什麼口味？", a: "酸辣", options: ["酸辣", "甜酸", "鹹鮮", "微辣"], hint: "泰式湯品特色" },
                    { q: "北京烤鴨是哪國名菜？", a: "中國", options: ["中國", "日本", "韓國", "越南"], hint: "中華料理經典" },
                    { q: "泡菜是什麼味道？", a: "辛辣酸", options: ["辛辣酸", "甜酸", "鹹鮮", "微甜"], hint: "韓式醃菜特色" },
                    { q: "泰國冬蔭功的主要食材之一？", a: "蝦", options: ["蝦", "雞肉", "豬肉", "牛肉"], hint: "海鮮湯品" },
                    { q: "壽司的主要材料之一是？", a: "生魚片", options: ["生魚片", "雞肉", "豬肉", "牛肉"], hint: "生魚片" }
                ]
            }
        };

        let currentChapter = '';
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;

        function showCoverPage() {
            hideAllPages();
            document.getElementById('coverPage').classList.remove('hidden');
        }

        function showMissionPage() {
            hideAllPages();
            document.getElementById('missionPage').classList.remove('hidden');
        }

        function showChapterPage() {
            hideAllPages();
            document.getElementById('chapterPage').classList.remove('hidden');
        }

        function showLearningPage(chapter) {
            hideAllPages();
            currentChapter = chapter;
            const data = gameData[chapter];
            
            document.getElementById('learningTitle').textContent = data.title;
            
            const cardsContainer = document.getElementById('learningCards');
            cardsContainer.innerHTML = '';
            
            data.cards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card-gradient backdrop-blur-sm rounded-2xl p-8 text-center transform hover:scale-105 transition-all duration-300 shadow-2xl border-2 border-white/30 glow';
                cardElement.innerHTML = `
                    <div class="text-6xl mb-4 bounce" style="animation-delay: ${Math.random() * 2}s">${card.flag}</div>
                    <h3 class="text-2xl font-bold text-white mb-4">${card.country}</h3>
                    <p class="text-white/90 text-lg leading-relaxed">${card.info}</p>
                `;
                cardsContainer.appendChild(cardElement);
            });
            
            document.getElementById('learningPage').classList.remove('hidden');
        }

        function startQuiz() {
            hideAllPages();
            const data = gameData[currentChapter];
            currentQuestions = shuffleArray([...data.questions]).slice(0, 5);
            currentQuestionIndex = 0;
            score = 0;
            
            resetGems();
            showQuestion();
            document.getElementById('quizPage').classList.remove('hidden');
        }

        function showQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            document.getElementById('questionProgress').textContent = `${currentQuestionIndex + 1}/5`;
            document.getElementById('questionText').textContent = question.q;
            
            const optionsContainer = document.getElementById('answerOptions');
            optionsContainer.innerHTML = '';
            
            const shuffledOptions = shuffleArray([...question.options]);
            shuffledOptions.forEach(option => {
                const button = document.createElement('button');
                button.className = 'w-full card-gradient hover:bg-white/40 text-white font-semibold py-6 px-8 rounded-2xl transition-all duration-300 transform hover:scale-105 text-xl shadow-lg border-2 border-white/30 glow hover:border-yellow-300/50';
                button.textContent = option;
                button.onclick = () => checkAnswer(option, question.a, question.hint);
                optionsContainer.appendChild(button);
            });
            
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('nextButton').classList.add('hidden');
        }

        function checkAnswer(selected, correct, hint) {
            const isCorrect = selected === correct;
            const feedbackElement = document.getElementById('feedback');
            const feedbackText = document.getElementById('feedbackText');
            
            if (isCorrect) {
                score++;
                feedbackText.innerHTML = `🎉 答對了！<br><span class="text-yellow-300">${hint}</span>`;
                feedbackElement.className = 'bg-green-500/20 backdrop-blur-sm rounded-3xl p-6 mb-6';
                updateGem(currentQuestionIndex + 1, true);
            } else {
                feedbackText.innerHTML = `❌ 答錯了！正確答案是：${correct}<br><span class="text-yellow-300">${hint}</span>`;
                feedbackElement.className = 'bg-red-500/20 backdrop-blur-sm rounded-3xl p-6 mb-6';
                updateGem(currentQuestionIndex + 1, false);
            }
            
            feedbackElement.classList.remove('hidden');
            
            // Disable all answer buttons
            const buttons = document.querySelectorAll('#answerOptions button');
            buttons.forEach(btn => {
                btn.disabled = true;
                btn.className = btn.className.replace('hover:bg-white/30', '').replace('hover:scale-105', '') + ' opacity-50';
            });
            
            setTimeout(() => {
                document.getElementById('nextButton').classList.remove('hidden');
            }, 1000);
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentQuestions.length) {
                showQuestion();
            } else {
                showCompletionPage();
            }
        }

        function showCompletionPage() {
            hideAllPages();
            const message = score === 5 ? 
                `完美！你獲得了 ${score}/5 顆寶石！` : 
                `不錯！你獲得了 ${score}/5 顆寶石！繼續努力！`;
            
            document.getElementById('completionMessage').textContent = message;
            document.getElementById('completionPage').classList.remove('hidden');
        }

        function updateGem(gemNumber, isCorrect) {
            const gem = document.getElementById(`gem${gemNumber}`);
            if (isCorrect) {
                gem.className = 'w-12 h-12 bg-yellow-400 rounded-full flex items-center justify-center sparkle text-2xl';
            } else {
                gem.className = 'w-12 h-12 bg-red-400 rounded-full flex items-center justify-center text-2xl';
            }
        }

        function resetGems() {
            for (let i = 1; i <= 5; i++) {
                const gem = document.getElementById(`gem${i}`);
                gem.className = 'w-12 h-12 bg-gray-400 rounded-full flex items-center justify-center text-2xl';
            }
        }

        function hideAllPages() {
            const pages = ['coverPage', 'missionPage', 'chapterPage', 'learningPage', 'quizPage', 'completionPage'];
            pages.forEach(page => {
                document.getElementById(page).classList.add('hidden');
            });
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96bf2b94228cf1f4',t:'MTc1NDY1Nzc0OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
